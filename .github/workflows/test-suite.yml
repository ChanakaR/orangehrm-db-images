name: OrangeHRM Database image test suite

on:
    push:
      branches: [ mariadb-10.2 ]
env:
    # Use docker.io for Docker Hub if empty
    REGISTRY: hub.docker.com
    # github.repository as <account>/<repo>
    IMAGE_REPO_NAME: "orangehrm/orangehrm-db-images"
    TEST_TAG_NAME: "mariadb-10.2"

jobs:
    test:
        runs-on: ubuntu-latest
        steps:
            - name: Checkout repository
              uses: actions/checkout@v2
            
            - name: Build docker image
              run: docker build -t ${{ env.IMAGE_REPO_NAME }}:${{ env.TEST_TAG_NAME }} docker-image

            - name: Spin up a container
              run: |
                docker images
                docker run -itd --name db_cotainer ${{ env.IMAGE_REPO_NAME }}:${{ env.TEST_TAG_NAME }}
                docker ps -a
            
            - name: Veirfy docker-compose installation
              run: |
                docker-compose --version
                docker --version